@model List<InquiryCardViewModel>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/css/bootstrap-datepicker.min.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.7.1/js/bootstrap-datepicker.min.js"></script>

@using Erp.BackOffice.App_GlobalResources
@using Erp.BackOffice.Sale.Models
@using Erp.BackOffice.Helpers
@using GridMvc.Html
@{
    ViewBag.Title = "Thống kê KH đã CSD nhưng chưa cập nhật mức độ hài lòng";
    bool isPopup = Request["IsPopup"] != null && Request["IsPopup"].ToString().ToLower() == "true" ? true : false;
    if (isPopup)
    {
        Layout = "~/Views/Shared/_PopupLayout.cshtml";
    }
    else
    {
        Layout = "~/Views/Shared/ACE_AdminLayout.cshtml";
    }

    Erp.BackOffice.Models.PageSetting pageSetting = new Erp.BackOffice.Models.PageSetting
    {
        ModuleName = "Plan",
        ActionName = "ThongKeKH",
        PageTitle = ViewBag.Title,
        DisplaySearchPanel = true,
        IsPopup = false,
        DisplayBackButton = true
    };
    IEnumerable<KH_TUONGTACViewModel> LSTUONGTAC = (IEnumerable<KH_TUONGTACViewModel>)ViewBag.LICHSUTUONGTAC;
    IEnumerable<Erp.BackOffice.Areas.Administration.Models.UserViewModel> user = (IEnumerable<Erp.BackOffice.Areas.Administration.Models.UserViewModel>)ViewBag.User;
    int index = 1;
}

<link href="@Url.Content("~/assets/css/Gridmvc.css")" rel="stylesheet" type="text/css" />
<script src="@Url.Content("~/Scripts/gridmvc.min.js")" type="text/javascript"></script>
@section HeadOfPage {
    <style>
        .ui-ribbon {
            position: relative;
            display: block;
            text-align: center;
            font-size: 15px;
            font-weight: 600;
            color: #fff;
            transform: rotate(43deg);
            padding: 7px 0;
            left: -2px;
            top: 19px;
            width: 140px;
            line-height: 20px;
            /*background-color: rgba(183, 51, 51, 0.94);*/
            box-shadow: 0 0 3px rgba(0,0,0,.3);
        }

        .ui-ribbon-wrapper {
            position: absolute;
            overflow: hidden;
            width: 108px;
            height: 103px;
            top: 0px;
            right: 12px;
            z-index: 1;
        }

        #myImg {
            height: 70px !important;
            width: 70px !important;
        }

        .search-media .search-actions {
            width: 30% !important;
            max-width: 250px !important;
            min-width: 150px !important;
        }

        .fa-150 {
            font-size: 1.5em;
        }

        tr.chua {
            background-color: #eababa;
        }
    </style>
}



@if (ViewBag.SuccessMessage != null && ViewBag.SuccessMessage != "")
{
    <div class="alert alert-block alert-success">
        <button class="close" data-dismiss="alert" type="button">
            <i class="ace-icon fa fa-times"></i>
        </button>
        <i class="ace-icon fa fa-check green"></i>
        @ViewBag.SuccessMessage
    </div>
}

@if (ViewBag.FailedMessage != null && ViewBag.FailedMessage != "")
{
    <div class="alert alert-block alert-danger">
        <button class="close" data-dismiss="alert" type="button">
            <i class="ace-icon fa fa-times"></i>
        </button>
        <i class="ace-icon fa fa-warning red"></i>
        @ViewBag.FailedMessage
    </div>
}
@helper GridColumnImage(string customercode, string name, string Image)
        {
    <div class="itemdiv commentdiv" style="height:72px!important;width:100%!important">
        <div class="user" style="height:72px;width:100%!important;">
            <div class="ace-thumbnails">
                <a href="@(Erp.BackOffice.Helpers.Common.KiemTraTonTaiHinhAnh(Image, "Customer", "user"))" title="@name" data-rel="colorbox" class="cboxElement">
                    <img id="myImg" alt="@name" src="@(Erp.BackOffice.Helpers.Common.KiemTraTonTaiHinhAnh(Image, "Customer", "user"))">
                </a>
            </div>
        </div>
        <div class="body">
            <div class="name" data-toggle="tooltip" title="Tên khách hàng">
                @name
            </div>
            <div class="text" data-toggle="tooltip" title="Mã khách hàng">
                @customercode
            </div>
        </div>
    </div>
}
<div class="tabbable" style="margin-bottom:50px;">

    @using (Html.BeginPageHeaderContainer(pageSetting))
    {
        <p>
            <label style="padding-left:40px">Chi nhánh</label>
            @Html.DropDownList("branchId", Erp.BackOffice.Helpers.SelectListHelper.GetSelectList_Branch(Request["branchId"], "Chi nhánh"), new { style = "width:138.4px" })

            <label style="padding-left:10px">Thời điểm </label>
            <span class="input-daterange input-group">
                @Html.TextBox("StartDate", Request["StartDate"] != null ? Request["StartDate"] : "", new { @class = "", autocomplete = "off", placeholder = "Từ ngày..." })
                <span class="input-group-addon">
                    <i class="fa fa-exchange"></i>
                </span>
                @Html.TextBox("EndDate", Request["EndDate"] != null ? Request["EndDate"] : "", new { @class = "", autocomplete = "off", placeholder = "Đến ngày..." })


            </span>
            @*<span class="input-daterange input-group">
                @Html.TextBox("EndDate", Request["EndDate"] != null ? Request["EndDate"] :DateTime.Now.ToString("dd,MM,yyyy"), new { @class = "", autocomplete = "off", placeholder = "Đến ngày..." })
                </span>*@
</p>
        
    }
    <div class="tab-content clear-fix">
        <div id="tab1" class="tab-pane active" style="margin-left:20px">
        </div>
        <div id="" class="table-responsive top-10 ">
            <table id="CTable" class="table table-bordered">
                <thead>
                    <tr>
                        <th rowspan="2" style="width:40px;text-align:center">STT</th>
                        <th rowspan="2" style="text-align:center">Mã phiếu YC</th>
                        <th rowspan="2" style="text-align:center">Ngày CSD</th>
                        <th rowspan="2" style="text-align:center">Mã khách hàng</th>
                        <th rowspan="2" style="text-align:center">Tên khách hàng</th>
                        <th rowspan="2" style="text-align:center">Điện thoại</th>
                        <th rowspan="2" style="text-align:center">Đánh giá KH</th>

                        @*<th rowspan="2" style="text-align:center">Mức độ hài lòng</th>
                        <th rowspan="2" style="text-align:center">Lịch tương tác</th>*@
                    </tr>
                    
                </thead>
                <tbody>
                    @foreach (var item in Model)
                    {
                        @*<tr class="@(index%2==0?"alert-warning":"")">*@
                        <tr>

                            <td>
                                <span>@(index++)</span>
                            </td>
                            <td>
                            <a onclick="OpenPopup('@Url.Action("Detail", "InquiryCard", new { area = "Sale", Id = item.InquiryCardId, IsPopup = "true" })', 'Trang chi tiết khách hàng', 0, 500)">
                                @item.Code</a></td>
                            <td>@item.WorkDay.Value.ToString("dd/MM/yyyy HH:mm")</td>
                            <td>@item.CustomerId</td>
                            <td>@item.CustomerName</td>
                            <td>@item.Phone</td>
                            <td><a name="Id" value="Id" onclick="OpenPopup('@Url.Action("EditNT", "Customer",new { area="Account",Id=@item.CustomerId, IsPopup =true})','',0,0)">Đánh giá KH</a></td>

                            
                        </tr>
                    }

                </tbody>
                <thead>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                    <tr></tr>
                </thead>
            </table>
        </div>
    </div>
</div>
<script>
    $('.input-daterange').datepicker({ format: 'dd/mm/yyyy' }).on('changeDate', function (e) {

    })
</script>

@section Scripts {
    @Html.ScriptBottom_ValidationMvc()
    @Html.ScriptBottom_DatePicker("dd/MM/yyyy")
    <script type="text/javascript">
       
       
    </script>
}
